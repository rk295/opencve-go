package main

import (
	"context"
	"fmt"
	"log"
	"os"

	"github.com/rk295/opencve-go/opencve"
)

func main() {
	username := os.Getenv(opencve.OpenCVEUsernameEnvName)
	password := os.Getenv(opencve.OpenCVEPasswordEnvName)

	ctx := context.Background()
	api, err := opencve.New(username, password, nil)
	if err != nil {
		log.Fatal(err)
	}

	vlist, err := api.SubscriptionsVendors().List(ctx)
	if err != nil {
		log.Fatal(err)
	}

	fmt.Println("Subscribed Vendors:")
	for _, i := range *vlist {
		fmt.Printf("* %s\n", i.HumanName)
	}

	fmt.Println()

	plist, err := api.SubscriptionsProducts().List(ctx)
	if err != nil {
		log.Fatal(err)
	}

	fmt.Println("Subscribed Products:")
	for _, i := range *plist {
		fmt.Printf("* %s/%s\n", i.ParentVendor, i.HumanName)
	}
}
