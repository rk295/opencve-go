package main

import (
	"context"
	"fmt"
	"log"
	"os"

	"github.com/rk295/opencve-golang/opencve"
)

func main() {
	username := os.Getenv(opencve.OpenCVEUsernameEnvName)
	password := os.Getenv(opencve.OpenCVEPasswordEnvName)

	ctx := context.Background()
	api, err := opencve.New(ctx, username, password, nil)
	if err != nil {
		log.Fatal(err)
	}

	list, err := api.CVEs().List(ctx)
	if err != nil {
		log.Fatal(err)
	}

	for _, cve := range *list {
		log.Printf("%s", cve.ID)
	}

	get, err := api.CVEs().Get(ctx, "CVE-2022-2326")
	if err != nil {
		log.Fatal(err)
	}

	fmt.Printf("id: %s\n", get.ID)
	fmt.Printf("summary: %s\n", get.Summary)
	fmt.Printf("score: %0.2f\n", get.Cvss.V3)
}
